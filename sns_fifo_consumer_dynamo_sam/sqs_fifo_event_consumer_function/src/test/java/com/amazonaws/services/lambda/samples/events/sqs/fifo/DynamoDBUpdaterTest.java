package com.amazonaws.services.lambda.samples.events.sqs.fifo;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;

import java.util.UUID;

import org.junit.jupiter.api.Test;
import com.amazonaws.services.dynamodbv2.AmazonDynamoDB;
import com.amazonaws.services.dynamodbv2.document.DynamoDB;
import com.amazonaws.services.dynamodbv2.document.Item;
import com.amazonaws.services.dynamodbv2.document.PutItemOutcome;
import com.amazonaws.services.dynamodbv2.document.Table;
import com.amazonaws.services.lambda.runtime.LambdaLogger;
import com.amazonaws.services.lambda.runtime.events.SQSEvent;
import com.amazonaws.services.lambda.runtime.events.SQSEvent.SQSMessage;
import com.amazonaws.services.lambda.samples.events.sqs.fifo.DynamoDBUpdater;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.google.gson.Gson;
import com.google.gson.GsonBuilder;

import org.mockito.ArgumentMatchers;

class DynamoDBUpdaterTest {
	
	private static final String sqsEventJson = "{\n"
			+ "    \"records\": [\n"
			+ "        {\n"
			+ "            \"messageId\": \"8f10fc89-3ad5-435a-9482-3cc9182845ae\",\n"
			+ "            \"receiptHandle\": \"AQEBeTKUaAQm4+0PC0LsQbZRYe69wgnCit0FtbDXIi3wbeCbFSd5OCODuAqdG7zTl8lWFYaCatE+jKbv5gNTKMn2uugVXd1q14TgX6DDWJknbzv6x5o6vVtwolMreHzsgaOxny2PytQ71umMURwFWlnmOeLTQN5zexCyivcut/S/wwpupadad95ocWio4Pb7nZpXdT70q1kvxmDA3v9L7JRUEyaibY0NxAcjdnnhS91zUQT8ScfxQ42XZxpumnGV4D/pISCMRCfoV4faj5CaEHMS9ilhdhiytm0hw9/uI2yWoBtySasxG529sPebpBFOyu9x\",\n"
			+ "            \"body\": \"{\\\"firstname\\\":\\\"Youlanda\\\",\\\"lastname\\\":\\\"Schemmer\\\",\\\"company\\\":\\\"Tri M Tool Inc\\\",\\\"street\\\":\\\"2881 Lewis Rd\\\",\\\"city\\\":\\\"Prineville\\\",\\\"county\\\":\\\"Crook\\\",\\\"state\\\":\\\"OR\\\",\\\"zip\\\":\\\"97754\\\",\\\"homePhone\\\":\\\"541-548-8197\\\",\\\"cellPhone\\\":\\\"541-993-2611\\\",\\\"email\\\":\\\"youlanda@aol.com\\\",\\\"website\\\":\\\"http://www.trimtoolinc.com\\\"}\",\n"
			+ "            \"md5OfBody\": \"74ae704a75e3f6fb0bc02533394779da\",\n"
			+ "            \"md5OfMessageAttributes\": \"176dd6e75fe5dbc3e122baeebc78f9a4\",\n"
			+ "            \"eventSourceArn\": \"arn:aws:sqs:us-west-2:664251831272:SQSFIFOLambdaDynamoDBSAMQueue.fifo\",\n"
			+ "            \"eventSource\": \"aws:sqs\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"attributes\": {\n"
			+ "                \"ApproximateReceiveCount\": \"1\",\n"
			+ "                \"SentTimestamp\": \"1689554641783\",\n"
			+ "                \"SequenceNumber\": \"18879270062006000384\",\n"
			+ "                \"MessageGroupId\": \"TestKey01-07-17-2023-00-07-86-OR\",\n"
			+ "                \"SenderId\": \"AROAZVKD6SPUBDQBNO3D6:i-006b46228e77ad83f\",\n"
			+ "                \"MessageDeduplicationId\": \"TestKey01-07-17-2023-00-07-86-40\",\n"
			+ "                \"ApproximateFirstReceiveTimestamp\": \"1689554643554\"\n"
			+ "            },\n"
			+ "            \"messageAttributes\": {\n"
			+ "                \"MessageKey\": {\n"
			+ "                    \"stringValue\": \"TestKey01-07-17-2023-00-07-86\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"MessageNumber\": {\n"
			+ "                    \"stringValue\": \"40\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"RepititionNumber\": {\n"
			+ "                    \"stringValue\": \"1\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                }\n"
			+ "            }\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"messageId\": \"e1a1a265-269d-4728-9285-714e31d16d03\",\n"
			+ "            \"receiptHandle\": \"AQEBm2Wf9lF9vsgQ3bat89pOuautciTjavX5HM2UUoFWojgZeCXDgb5nRd2tmXOZ+JOmz4VafWk4VwluFx1v7R4LPj4MrT86CLEc6Hv//KKE2jOEJhC41L47HJS90oKPMlHcGKctqxz7QjG4ky9LSCalEF3Gej5nAC5VEu4OESvp1/4GsFBSS8g0w3KT/Yngxk74r5X2LLNglynf4Gj50ivmr+Wsyy7PSuhiocGISguDgd4jlBR9onSvvdFrYmNrzm7DQQwaSBUWy/wVJo0U0JNa2Wfs4GMCOnmFw0RJNhat4iaTfuqWBXSasWHdrtQBsLI2\",\n"
			+ "            \"body\": \"{\\\"firstname\\\":\\\"Lavera\\\",\\\"lastname\\\":\\\"Perin\\\",\\\"company\\\":\\\"Abc Enterprises Inc\\\",\\\"street\\\":\\\"678 3rd Ave\\\",\\\"city\\\":\\\"Miami\\\",\\\"county\\\":\\\"Miami-Dade\\\",\\\"state\\\":\\\"FL\\\",\\\"zip\\\":\\\"33196\\\",\\\"homePhone\\\":\\\"305-606-7291\\\",\\\"cellPhone\\\":\\\"305-995-2078\\\",\\\"email\\\":\\\"lperin@perin.org\\\",\\\"website\\\":\\\"http://www.abcenterprisesinc.com\\\"}\",\n"
			+ "            \"md5OfBody\": \"1262b3ae08b2cb5fcd64a4fed44442b1\",\n"
			+ "            \"md5OfMessageAttributes\": \"567e89bf2fedd2385298cbee516ddce3\",\n"
			+ "            \"eventSourceArn\": \"arn:aws:sqs:us-west-2:664251831272:SQSFIFOLambdaDynamoDBSAMQueue.fifo\",\n"
			+ "            \"eventSource\": \"aws:sqs\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"attributes\": {\n"
			+ "                \"ApproximateReceiveCount\": \"1\",\n"
			+ "                \"SentTimestamp\": \"1689554641929\",\n"
			+ "                \"SequenceNumber\": \"18879270062043377664\",\n"
			+ "                \"MessageGroupId\": \"TestKey01-07-17-2023-00-07-86-FL\",\n"
			+ "                \"SenderId\": \"AROAZVKD6SPUBDQBNO3D6:i-006b46228e77ad83f\",\n"
			+ "                \"MessageDeduplicationId\": \"TestKey01-07-17-2023-00-07-86-43\",\n"
			+ "                \"ApproximateFirstReceiveTimestamp\": \"1689554643554\"\n"
			+ "            },\n"
			+ "            \"messageAttributes\": {\n"
			+ "                \"MessageKey\": {\n"
			+ "                    \"stringValue\": \"TestKey01-07-17-2023-00-07-86\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"MessageNumber\": {\n"
			+ "                    \"stringValue\": \"43\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"RepititionNumber\": {\n"
			+ "                    \"stringValue\": \"1\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                }\n"
			+ "            }\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"messageId\": \"447bcb89-f496-471c-8dd7-fb50e5aed3d6\",\n"
			+ "            \"receiptHandle\": \"AQEBvcqB944Pk23OopzJE1Vd7DGQfaktum2VyxS4Ev5K37hY2X2JNGiierqUkXlnar8glYfWgUFWk9IzMowygqh1f7vK4IXOiPB49ZAA27oT6jxjhsR05Bi/H2TvESIwPdT3bB+yVT6jkvunHCiX2YsToC5fw4yfbAclVgfRQOruY6vo2U4LRygVlAFioYCQSL8C+h9AmCQeF6G+k03NGfJEZB9GMj0QOZ/iS/jerFM2YGyqUEuzhyWSzvcUQQ8qQ9gogoWZJiTwWZG3CoP40EU6/Urw9dUmpGKe4IUpks9EyuO+YOaqGCTR0rxZxC/Fjiih\",\n"
			+ "            \"body\": \"{\\\"firstname\\\":\\\"Arlette\\\",\\\"lastname\\\":\\\"Honeywell\\\",\\\"company\\\":\\\"Smc Inc\\\",\\\"street\\\":\\\"11279 Loytan St\\\",\\\"city\\\":\\\"Jacksonville\\\",\\\"county\\\":\\\"Duval\\\",\\\"state\\\":\\\"FL\\\",\\\"zip\\\":\\\"32254\\\",\\\"homePhone\\\":\\\"904-775-4480\\\",\\\"cellPhone\\\":\\\"904-514-9918\\\",\\\"email\\\":\\\"ahoneywell@honeywell.com\\\",\\\"website\\\":\\\"http://www.smcinc.com\\\"}\",\n"
			+ "            \"md5OfBody\": \"6da4588286bf3b37f79f262d26d68e2d\",\n"
			+ "            \"md5OfMessageAttributes\": \"55fae44ec71e40037896d5c9e51462df\",\n"
			+ "            \"eventSourceArn\": \"arn:aws:sqs:us-west-2:664251831272:SQSFIFOLambdaDynamoDBSAMQueue.fifo\",\n"
			+ "            \"eventSource\": \"aws:sqs\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"attributes\": {\n"
			+ "                \"ApproximateReceiveCount\": \"1\",\n"
			+ "                \"SentTimestamp\": \"1689554642959\",\n"
			+ "                \"SequenceNumber\": \"18879270062307056896\",\n"
			+ "                \"MessageGroupId\": \"TestKey01-07-17-2023-00-07-86-FL\",\n"
			+ "                \"SenderId\": \"AROAZVKD6SPUBDQBNO3D6:i-006b46228e77ad83f\",\n"
			+ "                \"MessageDeduplicationId\": \"TestKey01-07-17-2023-00-07-86-82\",\n"
			+ "                \"ApproximateFirstReceiveTimestamp\": \"1689554643554\"\n"
			+ "            },\n"
			+ "            \"messageAttributes\": {\n"
			+ "                \"MessageKey\": {\n"
			+ "                    \"stringValue\": \"TestKey01-07-17-2023-00-07-86\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"MessageNumber\": {\n"
			+ "                    \"stringValue\": \"82\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"RepititionNumber\": {\n"
			+ "                    \"stringValue\": \"1\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                }\n"
			+ "            }\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"messageId\": \"446984d3-c4c6-4b4f-8d55-333e0c8e6ce4\",\n"
			+ "            \"receiptHandle\": \"AQEBPWA6Xh+CVDMKMkcWebY78ZndY/9GJo4c6ccGMHBKVx6qSt4UHMhXBxhkMZaZXwecJ77gT/aBmlBTFLqYA24n2ENxYlWhQCWertTT5Xy/1w6hwu0TgkA+Q/L7row+wDOkyoFQ4hTkTnv85cssJm5E6jHMx7trpmLTEMxTT+G1loGf24ASkjr89RjSc0F6y9xXL2b6W88url4LswVAQsuH8q++8p36ccNiQT+7cHuwCXz4Ah125EuIuW/BSOOdbMMUQYbuu3q4k7/NV2In6MtHaY+J3/jdwKdtOZ0U7OyXePlTuvCc8+BJ10VPhOhsp6Up\",\n"
			+ "            \"body\": \"{\\\"firstname\\\":\\\"Fatima\\\",\\\"lastname\\\":\\\"Saylors\\\",\\\"company\\\":\\\"\\\\\\\"Stanton, James D Esq\\\\\\\"\\\",\\\"street\\\":\\\"2 Lighthouse Ave\\\",\\\"city\\\":\\\"Hopkins\\\",\\\"county\\\":\\\"Hennepin\\\",\\\"state\\\":\\\"MN\\\",\\\"zip\\\":\\\"55343\\\",\\\"homePhone\\\":\\\"952-768-2416\\\",\\\"cellPhone\\\":\\\"952-479-2375\\\",\\\"email\\\":\\\"fsaylors@saylors.org\\\",\\\"website\\\":\\\"http://www.stantonjamesdesq.com\\\"}\",\n"
			+ "            \"md5OfBody\": \"4b0f49a42d201a696bb7edeee9779923\",\n"
			+ "            \"md5OfMessageAttributes\": \"5a42b4e5e5d5e5400110b436025a3a1b\",\n"
			+ "            \"eventSourceArn\": \"arn:aws:sqs:us-west-2:664251831272:SQSFIFOLambdaDynamoDBSAMQueue.fifo\",\n"
			+ "            \"eventSource\": \"aws:sqs\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"attributes\": {\n"
			+ "                \"ApproximateReceiveCount\": \"1\",\n"
			+ "                \"SentTimestamp\": \"1689554641982\",\n"
			+ "                \"SequenceNumber\": \"18879270062056944640\",\n"
			+ "                \"MessageGroupId\": \"TestKey01-07-17-2023-00-07-86-MN\",\n"
			+ "                \"SenderId\": \"AROAZVKD6SPUBDQBNO3D6:i-006b46228e77ad83f\",\n"
			+ "                \"MessageDeduplicationId\": \"TestKey01-07-17-2023-00-07-86-45\",\n"
			+ "                \"ApproximateFirstReceiveTimestamp\": \"1689554643554\"\n"
			+ "            },\n"
			+ "            \"messageAttributes\": {\n"
			+ "                \"MessageKey\": {\n"
			+ "                    \"stringValue\": \"TestKey01-07-17-2023-00-07-86\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"MessageNumber\": {\n"
			+ "                    \"stringValue\": \"45\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"RepititionNumber\": {\n"
			+ "                    \"stringValue\": \"1\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                }\n"
			+ "            }\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"messageId\": \"1e6f3dad-415a-4ded-b6ac-c055a16f80ec\",\n"
			+ "            \"receiptHandle\": \"AQEB8ATCxbt2gmWPQbRBGwxzdbVoGCVGGpq9Zp8kE4OHCbNHPRznOfqiWAaiEoT17xRT7PUuSjrSp7kfGdWVW6/wLn0SswzcjD3GKeWU/hwhGpd087K3vOri2dADuuHeJgEmcQ/iiWRsOAtlAdEgGRizNxND8HQHNi3UJDzKJRsZF1qcrp4LgkDLBAETe3qR6Ut94SD0fNSp4ZzshOVEnvubsXOHUOEgVMXZwQRxWX/iIerqCdWwLDoWoZ7Cdn2lLveDii9E4GV7OH573+GB5GZVxu3p/TAULuic2tLz64YaNuhrq5PdIL5eMTfgZl11YhDN\",\n"
			+ "            \"body\": \"{\\\"firstname\\\":\\\"Jina\\\",\\\"lastname\\\":\\\"Briddick\\\",\\\"company\\\":\\\"Grace Pastries Inc\\\",\\\"street\\\":\\\"38938 Park Blvd\\\",\\\"city\\\":\\\"Boston\\\",\\\"county\\\":\\\"Suffolk\\\",\\\"state\\\":\\\"MA\\\",\\\"zip\\\":\\\"2128\\\",\\\"homePhone\\\":\\\"617-399-5124\\\",\\\"cellPhone\\\":\\\"617-997-5771\\\",\\\"email\\\":\\\"jina_briddick@briddick.com\\\",\\\"website\\\":\\\"http://www.gracepastriesinc.com\\\"}\",\n"
			+ "            \"md5OfBody\": \"2419236f71b3810fe5655021f312edfe\",\n"
			+ "            \"md5OfMessageAttributes\": \"8bb603fdd8d71a3ca6f4cd14fa4d2d5a\",\n"
			+ "            \"eventSourceArn\": \"arn:aws:sqs:us-west-2:664251831272:SQSFIFOLambdaDynamoDBSAMQueue.fifo\",\n"
			+ "            \"eventSource\": \"aws:sqs\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"attributes\": {\n"
			+ "                \"ApproximateReceiveCount\": \"1\",\n"
			+ "                \"SentTimestamp\": \"1689554642010\",\n"
			+ "                \"SequenceNumber\": \"18879270062064112896\",\n"
			+ "                \"MessageGroupId\": \"TestKey01-07-17-2023-00-07-86-MA\",\n"
			+ "                \"SenderId\": \"AROAZVKD6SPUBDQBNO3D6:i-006b46228e77ad83f\",\n"
			+ "                \"MessageDeduplicationId\": \"TestKey01-07-17-2023-00-07-86-46\",\n"
			+ "                \"ApproximateFirstReceiveTimestamp\": \"1689554643554\"\n"
			+ "            },\n"
			+ "            \"messageAttributes\": {\n"
			+ "                \"MessageKey\": {\n"
			+ "                    \"stringValue\": \"TestKey01-07-17-2023-00-07-86\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"MessageNumber\": {\n"
			+ "                    \"stringValue\": \"46\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"RepititionNumber\": {\n"
			+ "                    \"stringValue\": \"1\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                }\n"
			+ "            }\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"messageId\": \"545c28ad-3ed9-4104-8754-0cceb439f117\",\n"
			+ "            \"receiptHandle\": \"AQEBF0RV9UszSOF8hRAs6yKv91l5g07VzSrK9jgezKuGVPLcg7dXZ2guIKVxaDUgOnSTHZhCUOFZ97GVfVt3DKwM7oyqq9hdGASx4DKRx0ON4e2oIUYLZFqiEuUbAfSomPflEB5kfSMTYkzcY3yOmTgKA5SxcJC9paxc/zOJ0T5i/YOh0FmnWPZuiuXdQDWYM6g2yZyeQIUF0I2q1OtyzhzT2SGo2D/hofhYwIxp3lpLQEHCulQO17NbSWYAUd6v1vnl786EPlTxtVBK117zDm5aOAWjyvPnjJcsZcmFezoaZDhDOFO0E1kpz+POsLk7JEzI\",\n"
			+ "            \"body\": \"{\\\"firstname\\\":\\\"Sabra\\\",\\\"lastname\\\":\\\"Uyetake\\\",\\\"company\\\":\\\"Lowy Limousine Service\\\",\\\"street\\\":\\\"98839 Hawthorne Blvd #6101\\\",\\\"city\\\":\\\"Columbia\\\",\\\"county\\\":\\\"Richland\\\",\\\"state\\\":\\\"SC\\\",\\\"zip\\\":\\\"29201\\\",\\\"homePhone\\\":\\\"803-925-5213\\\",\\\"cellPhone\\\":\\\"803-681-3678\\\",\\\"email\\\":\\\"sabra@uyetake.org\\\",\\\"website\\\":\\\"http://www.lowylimousineservice.com\\\"}\",\n"
			+ "            \"md5OfBody\": \"5a007b7dd73f11012dbb26e20dfa4738\",\n"
			+ "            \"md5OfMessageAttributes\": \"b29256b899104c7ea9562d770ab01380\",\n"
			+ "            \"eventSourceArn\": \"arn:aws:sqs:us-west-2:664251831272:SQSFIFOLambdaDynamoDBSAMQueue.fifo\",\n"
			+ "            \"eventSource\": \"aws:sqs\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"attributes\": {\n"
			+ "                \"ApproximateReceiveCount\": \"1\",\n"
			+ "                \"SentTimestamp\": \"1689554642154\",\n"
			+ "                \"SequenceNumber\": \"18879270062100976128\",\n"
			+ "                \"MessageGroupId\": \"TestKey01-07-17-2023-00-07-86-SC\",\n"
			+ "                \"SenderId\": \"AROAZVKD6SPUBDQBNO3D6:i-006b46228e77ad83f\",\n"
			+ "                \"MessageDeduplicationId\": \"TestKey01-07-17-2023-00-07-86-52\",\n"
			+ "                \"ApproximateFirstReceiveTimestamp\": \"1689554643554\"\n"
			+ "            },\n"
			+ "            \"messageAttributes\": {\n"
			+ "                \"MessageKey\": {\n"
			+ "                    \"stringValue\": \"TestKey01-07-17-2023-00-07-86\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"MessageNumber\": {\n"
			+ "                    \"stringValue\": \"52\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"RepititionNumber\": {\n"
			+ "                    \"stringValue\": \"1\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                }\n"
			+ "            }\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"messageId\": \"68ffe70e-b912-4d31-be9e-f82893d1da34\",\n"
			+ "            \"receiptHandle\": \"AQEB+d0Alwy0oItFLX/RGQk0xxOBxg/IEduFqrLDgUDz4we7/oYtKom22VVoR5nxaSXXNfj85yEhkw6XvIti8mD8hPjZBjo7+zZhmImYhpJ9tA38ieJ9pXUBzMcr1h5ErrMkxAzUW2xW2M7rg7WDHtjtGxAUWcyfrTSUbuXe86CspEdXvgpGU4i6TGkpZwspNXNtcOqIeq60zDoGq4XeHNAZTbOG+QyTTZwxY5in62v+LKsWuiTHA/zp0mzYSIc0XScb55UZ1a57dD8F5qC+74mlSWUYSPl1IO7mDh0EYvIB69JkvG1XSKKyxra0GrbN6lvu\",\n"
			+ "            \"body\": \"{\\\"firstname\\\":\\\"Delmy\\\",\\\"lastname\\\":\\\"Ahle\\\",\\\"company\\\":\\\"Wye Technologies Inc\\\",\\\"street\\\":\\\"65895 S 16th St\\\",\\\"city\\\":\\\"Providence\\\",\\\"county\\\":\\\"Providence\\\",\\\"state\\\":\\\"RI\\\",\\\"zip\\\":\\\"2909\\\",\\\"homePhone\\\":\\\"401-458-2547\\\",\\\"cellPhone\\\":\\\"401-559-8961\\\",\\\"email\\\":\\\"delmy.ahle@hotmail.com\\\",\\\"website\\\":\\\"http://www.wyetechnologiesinc.com\\\"}\",\n"
			+ "            \"md5OfBody\": \"62695cdd13ba05fd5516cb4d8e1bb863\",\n"
			+ "            \"md5OfMessageAttributes\": \"43de3bb1a1e4e64a84969e6b319ca38c\",\n"
			+ "            \"eventSourceArn\": \"arn:aws:sqs:us-west-2:664251831272:SQSFIFOLambdaDynamoDBSAMQueue.fifo\",\n"
			+ "            \"eventSource\": \"aws:sqs\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"attributes\": {\n"
			+ "                \"ApproximateReceiveCount\": \"1\",\n"
			+ "                \"SentTimestamp\": \"1689554642302\",\n"
			+ "                \"SequenceNumber\": \"18879270062138865664\",\n"
			+ "                \"MessageGroupId\": \"TestKey01-07-17-2023-00-07-86-RI\",\n"
			+ "                \"SenderId\": \"AROAZVKD6SPUBDQBNO3D6:i-006b46228e77ad83f\",\n"
			+ "                \"MessageDeduplicationId\": \"TestKey01-07-17-2023-00-07-86-58\",\n"
			+ "                \"ApproximateFirstReceiveTimestamp\": \"1689554643554\"\n"
			+ "            },\n"
			+ "            \"messageAttributes\": {\n"
			+ "                \"MessageKey\": {\n"
			+ "                    \"stringValue\": \"TestKey01-07-17-2023-00-07-86\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"MessageNumber\": {\n"
			+ "                    \"stringValue\": \"58\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"RepititionNumber\": {\n"
			+ "                    \"stringValue\": \"1\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                }\n"
			+ "            }\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"messageId\": \"09e74dee-e2fb-46f9-a1a0-dd80990c70a7\",\n"
			+ "            \"receiptHandle\": \"AQEBnh1EEopY+XwlM23VgyVi8Vq8tPgoVGIWQRT8dLw2BRPpmyuuu+PG0Gi3qbRrMZsFf6miUhatkhHDt+PMvENoIgj120Bo3eLe8PcCnPT0NkyD0D3AHwHkbWMSBsPH1H8E70HjcI6MZgcRK3KYJnR3sKl2HfhTO+hXp+rwE0j1WEFb/iBFCDX8GaOJhiJDoRkeBKqtBvaqh8i0TtBdhZ5V0Ce6viL31Drx2ozZBM1GGCZW9wklkYWwii+TlmlQas/3DIvB14H0A8DK5c8rNoECueExY9j6HhBUYiLhPlkf6zI9rkaN9nj5JzRy5VaEP+Y1\",\n"
			+ "            \"body\": \"{\\\"firstname\\\":\\\"Blondell\\\",\\\"lastname\\\":\\\"Pugh\\\",\\\"company\\\":\\\"Alpenlite Inc\\\",\\\"street\\\":\\\"201 Hawk Ct\\\",\\\"city\\\":\\\"Providence\\\",\\\"county\\\":\\\"Providence\\\",\\\"state\\\":\\\"RI\\\",\\\"zip\\\":\\\"2904\\\",\\\"homePhone\\\":\\\"401-960-8259\\\",\\\"cellPhone\\\":\\\"401-300-8122\\\",\\\"email\\\":\\\"bpugh@aol.com\\\",\\\"website\\\":\\\"http://www.alpenliteinc.com\\\"}\",\n"
			+ "            \"md5OfBody\": \"6b7e089cffbca5d5d62ddacd5f8d7592\",\n"
			+ "            \"md5OfMessageAttributes\": \"d51288091532172dbf1cdaef7383abf9\",\n"
			+ "            \"eventSourceArn\": \"arn:aws:sqs:us-west-2:664251831272:SQSFIFOLambdaDynamoDBSAMQueue.fifo\",\n"
			+ "            \"eventSource\": \"aws:sqs\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"attributes\": {\n"
			+ "                \"ApproximateReceiveCount\": \"1\",\n"
			+ "                \"SentTimestamp\": \"1689554642371\",\n"
			+ "                \"SequenceNumber\": \"18879270062156527616\",\n"
			+ "                \"MessageGroupId\": \"TestKey01-07-17-2023-00-07-86-RI\",\n"
			+ "                \"SenderId\": \"AROAZVKD6SPUBDQBNO3D6:i-006b46228e77ad83f\",\n"
			+ "                \"MessageDeduplicationId\": \"TestKey01-07-17-2023-00-07-86-60\",\n"
			+ "                \"ApproximateFirstReceiveTimestamp\": \"1689554643554\"\n"
			+ "            },\n"
			+ "            \"messageAttributes\": {\n"
			+ "                \"MessageKey\": {\n"
			+ "                    \"stringValue\": \"TestKey01-07-17-2023-00-07-86\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"MessageNumber\": {\n"
			+ "                    \"stringValue\": \"60\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"RepititionNumber\": {\n"
			+ "                    \"stringValue\": \"1\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                }\n"
			+ "            }\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"messageId\": \"7fde7a86-eeee-4c22-a4e0-e695a59996c8\",\n"
			+ "            \"receiptHandle\": \"AQEBG20qDujHQuXFRP396lGW3tByf9veHRnHs1VMn/3iltL0wxcbOLoUk9SzAqDBWgJnL2sqi+5zPqupSdH95yJDyJh8h2zRAoXeQAe+zgKLlTaVE1WriNx/2612cKxq4OzOmnIh8nkUCpNikmdT4ipibM+vwVfanRAzMlimIvRUBuL9mh5dkt9esw6+MJg9uGNnT22BZnqCRU5c9ifa47kN/rdPRx8ACsd+VlCgWbmsdIELSrkF6hRM3dDSQje1PpbytjPIsvkRqqgcZVzdZpwgSdOPWJrnYrX96RF6izVknuhbNyOUyeeOhvdotQtV3UnG\",\n"
			+ "            \"body\": \"{\\\"firstname\\\":\\\"Carmelina\\\",\\\"lastname\\\":\\\"Lindall\\\",\\\"company\\\":\\\"George Jessop Carter Jewelers\\\",\\\"street\\\":\\\"2664 Lewis Rd\\\",\\\"city\\\":\\\"Littleton\\\",\\\"county\\\":\\\"Douglas\\\",\\\"state\\\":\\\"CO\\\",\\\"zip\\\":\\\"80126\\\",\\\"homePhone\\\":\\\"303-724-7371\\\",\\\"cellPhone\\\":\\\"303-874-5160\\\",\\\"email\\\":\\\"carmelina_lindall@lindall.com\\\",\\\"website\\\":\\\"http://www.georgejessopcarterjewelers.com\\\"}\",\n"
			+ "            \"md5OfBody\": \"74ec24be5ca141167f142d46b482a6ee\",\n"
			+ "            \"md5OfMessageAttributes\": \"5eca3ba1b48186613ffc349768d8faf3\",\n"
			+ "            \"eventSourceArn\": \"arn:aws:sqs:us-west-2:664251831272:SQSFIFOLambdaDynamoDBSAMQueue.fifo\",\n"
			+ "            \"eventSource\": \"aws:sqs\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"attributes\": {\n"
			+ "                \"ApproximateReceiveCount\": \"1\",\n"
			+ "                \"SentTimestamp\": \"1689554642432\",\n"
			+ "                \"SequenceNumber\": \"18879270062172143616\",\n"
			+ "                \"MessageGroupId\": \"TestKey01-07-17-2023-00-07-86-CO\",\n"
			+ "                \"SenderId\": \"AROAZVKD6SPUBDQBNO3D6:i-006b46228e77ad83f\",\n"
			+ "                \"MessageDeduplicationId\": \"TestKey01-07-17-2023-00-07-86-63\",\n"
			+ "                \"ApproximateFirstReceiveTimestamp\": \"1689554643554\"\n"
			+ "            },\n"
			+ "            \"messageAttributes\": {\n"
			+ "                \"MessageKey\": {\n"
			+ "                    \"stringValue\": \"TestKey01-07-17-2023-00-07-86\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"MessageNumber\": {\n"
			+ "                    \"stringValue\": \"63\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"RepititionNumber\": {\n"
			+ "                    \"stringValue\": \"1\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                }\n"
			+ "            }\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"messageId\": \"12d8e9b9-c2fe-44fe-85b9-a0061e660718\",\n"
			+ "            \"receiptHandle\": \"AQEBz14EyGhqKSc6dPDJvMDtsgUQpNJKzFimYZDhVxP50MbnUoaDbaBI1P6JJ7d+JSLpl3xQwoOLSYDS2xpea7MXltTrsWEVVDYlgpzGOxseKSWur6bBuIN4yCu5ObWCaUNztoxFfxkLT5h3BisjbmDEjhZuPDhwkP21mdkeiRAbNcPmey3lEvqc6wYyRiqycAcuXsc4Eqvy4dd/Za4cf/JqVXgw+7tbtLqYwiIGN/7V3P3qWfkooYvS/GFlVD8t7YQ7g68kmLRk0w5P+WR96hfxwDeshBcc2/yMqwPN2vODGKJLgl9Jm3SLOwfMtUGQjer0\",\n"
			+ "            \"body\": \"{\\\"firstname\\\":\\\"Alease\\\",\\\"lastname\\\":\\\"Buemi\\\",\\\"company\\\":\\\"Porto Cayo At Hawks Cay\\\",\\\"street\\\":\\\"4 Webbs Chapel Rd\\\",\\\"city\\\":\\\"Boulder\\\",\\\"county\\\":\\\"Boulder\\\",\\\"state\\\":\\\"CO\\\",\\\"zip\\\":\\\"80303\\\",\\\"homePhone\\\":\\\"303-301-4946\\\",\\\"cellPhone\\\":\\\"303-521-9860\\\",\\\"email\\\":\\\"alease@buemi.com\\\",\\\"website\\\":\\\"http://www.portocayoathawkscay.com\\\"}\",\n"
			+ "            \"md5OfBody\": \"5d98aae9eb83ef2de26a7437f112a35f\",\n"
			+ "            \"md5OfMessageAttributes\": \"3800cd5b73cc149bada4d7043eb067c7\",\n"
			+ "            \"eventSourceArn\": \"arn:aws:sqs:us-west-2:664251831272:SQSFIFOLambdaDynamoDBSAMQueue.fifo\",\n"
			+ "            \"eventSource\": \"aws:sqs\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"attributes\": {\n"
			+ "                \"ApproximateReceiveCount\": \"1\",\n"
			+ "                \"SentTimestamp\": \"1689554643329\",\n"
			+ "                \"SequenceNumber\": \"18879270062401776128\",\n"
			+ "                \"MessageGroupId\": \"TestKey01-07-17-2023-00-07-86-CO\",\n"
			+ "                \"SenderId\": \"AROAZVKD6SPUBDQBNO3D6:i-006b46228e77ad83f\",\n"
			+ "                \"MessageDeduplicationId\": \"TestKey01-07-17-2023-00-07-86-100\",\n"
			+ "                \"ApproximateFirstReceiveTimestamp\": \"1689554643554\"\n"
			+ "            },\n"
			+ "            \"messageAttributes\": {\n"
			+ "                \"MessageKey\": {\n"
			+ "                    \"stringValue\": \"TestKey01-07-17-2023-00-07-86\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"MessageNumber\": {\n"
			+ "                    \"stringValue\": \"100\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                },\n"
			+ "                \"RepititionNumber\": {\n"
			+ "                    \"stringValue\": \"1\",\n"
			+ "                    \"binaryValue\": null,\n"
			+ "                    \"stringListValues\": [],\n"
			+ "                    \"binaryListValues\": [],\n"
			+ "                    \"dataType\": \"String\"\n"
			+ "                }\n"
			+ "            }\n"
			+ "        }\n"
			+ "    ]\n"
			+ "}";

	@Test
	void testDynamoDBUpdater() {
		DynamoDBUpdater ddbUpdater = new DynamoDBUpdater("DBTable");
		assertNotNull(ddbUpdater);
		assertEquals(ddbUpdater.dynamoDBTableName, "DBTable");
		assertNotNull(ddbUpdater.client);
		assertNotNull(ddbUpdater.dynamoDB);
		assertNotNull(ddbUpdater.dynamoTable);
	}

	@Test
	void testInsertIntoDynamoDB() {

		Gson gson = new GsonBuilder().setPrettyPrinting().create();
		//SQSEvent event = gson.fromJson(sqsEventJson, SQSEvent.class);
		ObjectMapper om = new ObjectMapper();
		//SQSEvent event = gson.fromJson(sqsEventJson, SQSEvent.class);
		SQSEvent event = null;
		try {
			event = om.readValue(sqsEventJson, SQSEvent.class);
		} catch (JsonMappingException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (JsonProcessingException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		for(SQSMessage msg : event.getRecords()){
			Table dynamoDbTable = mock(Table.class);
		    AmazonDynamoDB client = mock(AmazonDynamoDB.class);
			DynamoDB dynamoDB = mock(DynamoDB.class);
		    PutItemOutcome putoutcome = mock(PutItemOutcome.class);
		    LambdaLogger logger = mock(LambdaLogger.class);
		    DynamoDBUpdater ddbUpdater = new DynamoDBUpdater("DBTable");
		    ddbUpdater.client = client;
		    ddbUpdater.dynamoDB = dynamoDB;
		    ddbUpdater.dynamoTable = dynamoDbTable;
		    when(ddbUpdater.dynamoTable.putItem(ArgumentMatchers.any(Item.class))).thenReturn(putoutcome);
			PutItemOutcome putOutcome = ddbUpdater.insertIntoDynamoDB(msg, gson, logger, System.currentTimeMillis(), UUID.randomUUID().toString());
			assertNotNull(putOutcome);
		}
	    
	}
}
