package com.amazonaws.services.lambda.samples.events.dynamodbstreams;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;
import org.junit.jupiter.api.Test;
import com.amazonaws.services.dynamodbv2.AmazonDynamoDB;
import com.amazonaws.services.dynamodbv2.document.DynamoDB;
import com.amazonaws.services.dynamodbv2.document.Item;
import com.amazonaws.services.dynamodbv2.document.PutItemOutcome;
import com.amazonaws.services.dynamodbv2.document.Table;
import com.amazonaws.services.lambda.runtime.LambdaLogger;
import com.amazonaws.services.lambda.runtime.events.SQSEvent;
import com.amazonaws.services.lambda.runtime.events.SQSEvent.SQSMessage;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.google.gson.Gson;
import com.google.gson.GsonBuilder;

import org.mockito.ArgumentMatchers;

class DynamoDBUpdaterTest {
	
	private static final String sqsEventJson = "{\n"
			+ "    \"records\": [\n"
			+ "        {\n"
			+ "            \"eventID\": \"9ab8fb4579283a34121ffde6c5ea67d8\",\n"
			+ "            \"eventName\": \"INSERT\",\n"
			+ "            \"eventVersion\": \"1.1\",\n"
			+ "            \"eventSource\": \"aws:dynamodb\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"dynamodb\": {\n"
			+ "                \"approximateCreationDateTime\": 1688452414000,\n"
			+ "                \"keys\": {\n"
			+ "                    \"MessageID\": {\n"
			+ "                        \"s\": \"TestMessage01-07-04-2023-06-07-30-1\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    }\n"
			+ "                },\n"
			+ "                \"newImage\": {\n"
			+ "                    \"Zip\": {\n"
			+ "                        \"s\": \"48116\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Company\": {\n"
			+ "                        \"s\": \"\\\"Chanay, Jeffrey A Esq\\\"\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Email\": {\n"
			+ "                        \"s\": \"josephine_darakjy@darakjy.org\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"TimeToLive\": {\n"
			+ "                        \"s\": null,\n"
			+ "                        \"n\": \"1688456013\",\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Lastname\": {\n"
			+ "                        \"s\": \"Darakjy\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Website\": {\n"
			+ "                        \"s\": \"http://www.chanayjeffreyaesq.com\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"City\": {\n"
			+ "                        \"s\": \"Brighton\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Address_Street\": {\n"
			+ "                        \"s\": \"4 B Blue Ridge Blvd\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"County\": {\n"
			+ "                        \"s\": \"Livingston\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Firstname\": {\n"
			+ "                        \"s\": \"Josephine\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Home_Phone\": {\n"
			+ "                        \"s\": \"810-292-9388\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"State\": {\n"
			+ "                        \"s\": \"MI\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Cell_Phone\": {\n"
			+ "                        \"s\": \"810-374-9840\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"MessageID\": {\n"
			+ "                        \"s\": \"TestMessage01-07-04-2023-06-07-30-1\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    }\n"
			+ "                },\n"
			+ "                \"oldImage\": null,\n"
			+ "                \"sequenceNumber\": \"100000000015186703778\",\n"
			+ "                \"sizeBytes\": 360,\n"
			+ "                \"streamViewType\": \"NEW_IMAGE\"\n"
			+ "            },\n"
			+ "            \"userIdentity\": null,\n"
			+ "            \"eventSourceARN\": \"arn:aws:dynamodb:us-west-2:664251831272:table/StreamsProducerDynamoDBTable/stream/2023-07-04T06:16:42.688\"\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"eventID\": \"4f6099b5729e450a030df485dbd317dc\",\n"
			+ "            \"eventName\": \"INSERT\",\n"
			+ "            \"eventVersion\": \"1.1\",\n"
			+ "            \"eventSource\": \"aws:dynamodb\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"dynamodb\": {\n"
			+ "                \"approximateCreationDateTime\": 1688452414000,\n"
			+ "                \"keys\": {\n"
			+ "                    \"MessageID\": {\n"
			+ "                        \"s\": \"TestMessage01-07-04-2023-06-07-30-3\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    }\n"
			+ "                },\n"
			+ "                \"newImage\": {\n"
			+ "                    \"Zip\": {\n"
			+ "                        \"s\": \"99501\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Company\": {\n"
			+ "                        \"s\": \"Feltz Printing Service\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Email\": {\n"
			+ "                        \"s\": \"lpaprocki@hotmail.com\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"TimeToLive\": {\n"
			+ "                        \"s\": null,\n"
			+ "                        \"n\": \"1688456013\",\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Lastname\": {\n"
			+ "                        \"s\": \"Paprocki\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Website\": {\n"
			+ "                        \"s\": \"http://www.feltzprintingservice.com\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"City\": {\n"
			+ "                        \"s\": \"Anchorage\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Address_Street\": {\n"
			+ "                        \"s\": \"639 Main St\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"County\": {\n"
			+ "                        \"s\": \"Anchorage\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Firstname\": {\n"
			+ "                        \"s\": \"Lenna\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Home_Phone\": {\n"
			+ "                        \"s\": \"907-385-4412\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"State\": {\n"
			+ "                        \"s\": \"AK\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Cell_Phone\": {\n"
			+ "                        \"s\": \"907-921-2010\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"MessageID\": {\n"
			+ "                        \"s\": \"TestMessage01-07-04-2023-06-07-30-3\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    }\n"
			+ "                },\n"
			+ "                \"oldImage\": null,\n"
			+ "                \"sequenceNumber\": \"200000000015186703845\",\n"
			+ "                \"sizeBytes\": 343,\n"
			+ "                \"streamViewType\": \"NEW_IMAGE\"\n"
			+ "            },\n"
			+ "            \"userIdentity\": null,\n"
			+ "            \"eventSourceARN\": \"arn:aws:dynamodb:us-west-2:664251831272:table/StreamsProducerDynamoDBTable/stream/2023-07-04T06:16:42.688\"\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"eventID\": \"36fd82ab85dcfb4946a700ebdea4cb72\",\n"
			+ "            \"eventName\": \"INSERT\",\n"
			+ "            \"eventVersion\": \"1.1\",\n"
			+ "            \"eventSource\": \"aws:dynamodb\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"dynamodb\": {\n"
			+ "                \"approximateCreationDateTime\": 1688452414000,\n"
			+ "                \"keys\": {\n"
			+ "                    \"MessageID\": {\n"
			+ "                        \"s\": \"TestMessage01-07-04-2023-06-07-30-6\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    }\n"
			+ "                },\n"
			+ "                \"newImage\": {\n"
			+ "                    \"Zip\": {\n"
			+ "                        \"s\": \"60632\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Company\": {\n"
			+ "                        \"s\": \"Morlong Associates\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Email\": {\n"
			+ "                        \"s\": \"mitsue_tollner@yahoo.com\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"TimeToLive\": {\n"
			+ "                        \"s\": null,\n"
			+ "                        \"n\": \"1688456014\",\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Lastname\": {\n"
			+ "                        \"s\": \"Tollner\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Website\": {\n"
			+ "                        \"s\": \"http://www.morlongassociates.com\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"City\": {\n"
			+ "                        \"s\": \"Chicago\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Address_Street\": {\n"
			+ "                        \"s\": \"7 Eads St\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"County\": {\n"
			+ "                        \"s\": \"Cook\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Firstname\": {\n"
			+ "                        \"s\": \"Mitsue\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Home_Phone\": {\n"
			+ "                        \"s\": \"773-573-6914\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"State\": {\n"
			+ "                        \"s\": \"IL\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Cell_Phone\": {\n"
			+ "                        \"s\": \"773-924-8565\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"MessageID\": {\n"
			+ "                        \"s\": \"TestMessage01-07-04-2023-06-07-30-6\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    }\n"
			+ "                },\n"
			+ "                \"oldImage\": null,\n"
			+ "                \"sequenceNumber\": \"300000000015186703852\",\n"
			+ "                \"sizeBytes\": 330,\n"
			+ "                \"streamViewType\": \"NEW_IMAGE\"\n"
			+ "            },\n"
			+ "            \"userIdentity\": null,\n"
			+ "            \"eventSourceARN\": \"arn:aws:dynamodb:us-west-2:664251831272:table/StreamsProducerDynamoDBTable/stream/2023-07-04T06:16:42.688\"\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"eventID\": \"e58aa306be30961dddfcdfb05f54eec6\",\n"
			+ "            \"eventName\": \"INSERT\",\n"
			+ "            \"eventVersion\": \"1.1\",\n"
			+ "            \"eventSource\": \"aws:dynamodb\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"dynamodb\": {\n"
			+ "                \"approximateCreationDateTime\": 1688452414000,\n"
			+ "                \"keys\": {\n"
			+ "                    \"MessageID\": {\n"
			+ "                        \"s\": \"TestMessage01-07-04-2023-06-07-30-7\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    }\n"
			+ "                },\n"
			+ "                \"newImage\": {\n"
			+ "                    \"Zip\": {\n"
			+ "                        \"s\": \"95111\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Company\": {\n"
			+ "                        \"s\": \"Commercial Press\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Email\": {\n"
			+ "                        \"s\": \"leota@hotmail.com\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"TimeToLive\": {\n"
			+ "                        \"s\": null,\n"
			+ "                        \"n\": \"1688456014\",\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Lastname\": {\n"
			+ "                        \"s\": \"Dilliard\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Website\": {\n"
			+ "                        \"s\": \"http://www.commercialpress.com\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"City\": {\n"
			+ "                        \"s\": \"San Jose\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Address_Street\": {\n"
			+ "                        \"s\": \"7 W Jackson Blvd\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"County\": {\n"
			+ "                        \"s\": \"Santa Clara\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Firstname\": {\n"
			+ "                        \"s\": \"Leota\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Home_Phone\": {\n"
			+ "                        \"s\": \"408-752-3500\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"State\": {\n"
			+ "                        \"s\": \"CA\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Cell_Phone\": {\n"
			+ "                        \"s\": \"408-813-1105\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"MessageID\": {\n"
			+ "                        \"s\": \"TestMessage01-07-04-2023-06-07-30-7\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    }\n"
			+ "                },\n"
			+ "                \"oldImage\": null,\n"
			+ "                \"sequenceNumber\": \"400000000015186703853\",\n"
			+ "                \"sizeBytes\": 334,\n"
			+ "                \"streamViewType\": \"NEW_IMAGE\"\n"
			+ "            },\n"
			+ "            \"userIdentity\": null,\n"
			+ "            \"eventSourceARN\": \"arn:aws:dynamodb:us-west-2:664251831272:table/StreamsProducerDynamoDBTable/stream/2023-07-04T06:16:42.688\"\n"
			+ "        },\n"
			+ "        {\n"
			+ "            \"eventID\": \"e0eb537c8a493c8ac9c12d2efbd1762d\",\n"
			+ "            \"eventName\": \"INSERT\",\n"
			+ "            \"eventVersion\": \"1.1\",\n"
			+ "            \"eventSource\": \"aws:dynamodb\",\n"
			+ "            \"awsRegion\": \"us-west-2\",\n"
			+ "            \"dynamodb\": {\n"
			+ "                \"approximateCreationDateTime\": 1688452414000,\n"
			+ "                \"keys\": {\n"
			+ "                    \"MessageID\": {\n"
			+ "                        \"s\": \"TestMessage01-07-04-2023-06-07-30-9\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    }\n"
			+ "                },\n"
			+ "                \"newImage\": {\n"
			+ "                    \"Zip\": {\n"
			+ "                        \"s\": \"21224\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Company\": {\n"
			+ "                        \"s\": \"\\\"King, Christopher A Esq\\\"\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Email\": {\n"
			+ "                        \"s\": \"kris@gmail.com\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"TimeToLive\": {\n"
			+ "                        \"s\": null,\n"
			+ "                        \"n\": \"1688456014\",\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Lastname\": {\n"
			+ "                        \"s\": \"Marrier\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Website\": {\n"
			+ "                        \"s\": \"http://www.kingchristopheraesq.com\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"City\": {\n"
			+ "                        \"s\": \"Baltimore\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Address_Street\": {\n"
			+ "                        \"s\": \"228 Runamuck Pl #2808\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"County\": {\n"
			+ "                        \"s\": \"Baltimore City\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Firstname\": {\n"
			+ "                        \"s\": \"Kris\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Home_Phone\": {\n"
			+ "                        \"s\": \"410-655-8723\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"State\": {\n"
			+ "                        \"s\": \"MD\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"Cell_Phone\": {\n"
			+ "                        \"s\": \"410-804-4694\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    },\n"
			+ "                    \"MessageID\": {\n"
			+ "                        \"s\": \"TestMessage01-07-04-2023-06-07-30-9\",\n"
			+ "                        \"n\": null,\n"
			+ "                        \"b\": null,\n"
			+ "                        \"m\": null,\n"
			+ "                        \"l\": null,\n"
			+ "                        \"null\": null,\n"
			+ "                        \"bool\": null,\n"
			+ "                        \"ss\": null,\n"
			+ "                        \"ns\": null,\n"
			+ "                        \"bs\": null\n"
			+ "                    }\n"
			+ "                },\n"
			+ "                \"oldImage\": null,\n"
			+ "                \"sequenceNumber\": \"500000000015186703854\",\n"
			+ "                \"sizeBytes\": 351,\n"
			+ "                \"streamViewType\": \"NEW_IMAGE\"\n"
			+ "            },\n"
			+ "            \"userIdentity\": null,\n"
			+ "            \"eventSourceARN\": \"arn:aws:dynamodb:us-west-2:664251831272:table/StreamsProducerDynamoDBTable/stream/2023-07-04T06:16:42.688\"\n"
			+ "        }\n"
			+ "    ]\n"
			+ "}";

//	@Test
//	void testDynamoDBUpdater() {
//		DynamoDBUpdater ddbUpdater = new DynamoDBUpdater("DBTable");
//		assertNotNull(ddbUpdater);
//		assertEquals(ddbUpdater.dynamoDBTableName, "DBTable");
//		assertNotNull(ddbUpdater.client);
//		assertNotNull(ddbUpdater.dynamoDB);
//		assertNotNull(ddbUpdater.dynamoTable);
//	}
//
//	@Test
//	void testInsertIntoDynamoDB() {
//
//		Gson gson = new GsonBuilder().setPrettyPrinting().create();
//		//SQSEvent event = gson.fromJson(sqsEventJson, SQSEvent.class);
//		ObjectMapper om = new ObjectMapper();
//		//SQSEvent event = gson.fromJson(sqsEventJson, SQSEvent.class);
//		SQSEvent event = null;
//		try {
//			event = om.readValue(sqsEventJson, SQSEvent.class);
//		} catch (JsonMappingException e) {
//			// TODO Auto-generated catch block
//			e.printStackTrace();
//		} catch (JsonProcessingException e) {
//			// TODO Auto-generated catch block
//			e.printStackTrace();
//		}
//		for(SQSMessage msg : event.getRecords()){
//			Table dynamoDbTable = mock(Table.class);
//		    AmazonDynamoDB client = mock(AmazonDynamoDB.class);
//			DynamoDB dynamoDB = mock(DynamoDB.class);
//		    PutItemOutcome putoutcome = mock(PutItemOutcome.class);
//		    LambdaLogger logger = mock(LambdaLogger.class);
//		    DynamoDBUpdater ddbUpdater = new DynamoDBUpdater("DBTable");
//		    ddbUpdater.client = client;
//		    ddbUpdater.dynamoDB = dynamoDB;
//		    ddbUpdater.dynamoTable = dynamoDbTable;
//		    when(ddbUpdater.dynamoTable.putItem(ArgumentMatchers.any(Item.class))).thenReturn(putoutcome);
//			PutItemOutcome putOutcome = ddbUpdater.insertIntoDynamoDB(msg, gson, logger);
//			assertNotNull(putOutcome);
//		}
//	    
//	}
}
