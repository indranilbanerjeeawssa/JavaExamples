package com.amazonaws.services.lambda.samples.events.rabbitmq;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.mockito.Mockito.mock;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
//import com.amazonaws.services.dynamodbv2.document.PutItemOutcome;
import com.amazonaws.services.lambda.runtime.Context;
import com.amazonaws.services.lambda.runtime.events.RabbitMQEvent;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;

class HandlerRabbitMQTest {

	private static final String mqEventJson = "{\n"
			+ "    \"eventSource\": \"aws:rmq\",\n"
			+ "    \"eventSourceArn\": \"arn:aws:mq:us-west-2:664251831272:broker:ib-rabbitmq-broker:b-22450561-3f76-4004-813d-392346f054fe\",\n"
			+ "    \"rmqMessagesByQueue\": {\n"
			+ "        \"LambdaRabbitMQQueue::/\": [\n"
			+ "            {\n"
			+ "                \"basicProperties\": {\n"
			+ "                    \"contentType\": \"text/plain\",\n"
			+ "                    \"contentEncoding\": \"UTF-8\",\n"
			+ "                    \"headers\": {\n"
			+ "                        \"MessageNumberInBatch\": 1,\n"
			+ "                        \"MessageBatchIdentifier\": {\n"
			+ "                            \"bytes\": [\n"
			+ "                                84,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                116,\n"
			+ "                                77,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                115,\n"
			+ "                                97,\n"
			+ "                                103,\n"
			+ "                                101,\n"
			+ "                                48,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                49,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48\n"
			+ "                            ]\n"
			+ "                        }\n"
			+ "                    },\n"
			+ "                    \"deliveryMode\": 2,\n"
			+ "                    \"priority\": 1,\n"
			+ "                    \"correlationId\": \"TestMessage03-07-02-2023-01-07-20-1\",\n"
			+ "                    \"replyTo\": null,\n"
			+ "                    \"expiration\": 60000,\n"
			+ "                    \"messageId\": \"TestMessage03-07-02-2023-01-07-20:1\",\n"
			+ "                    \"timestamp\": \"Jul 2, 2023, 1:30:34 AM\",\n"
			+ "                    \"type\": \"JsonRabbitMQProducer\",\n"
			+ "                    \"userId\": \"admin\",\n"
			+ "                    \"appId\": \"rabbitmq.producer.JsonRabbitMQProducer\",\n"
			+ "                    \"clusterId\": \"b-22450561-3f76-4004-813d-392346f054fe.mq.us-west-2.amazonaws.com\",\n"
			+ "                    \"bodySize\": 321\n"
			+ "                },\n"
			+ "                \"redelivered\": false,\n"
			+ "                \"data\": \"eyJmaXJzdG5hbWUiOiJKb3NlcGhpbmUiLCJsYXN0bmFtZSI6IkRhcmFrankiLCJjb21wYW55IjoiXCJDaGFuYXksIEplZmZyZXkgQSBFc3FcIiIsInN0cmVldCI6IjQgQiBCbHVlIFJpZGdlIEJsdmQiLCJjaXR5IjoiQnJpZ2h0b24iLCJjb3VudHkiOiJMaXZpbmdzdG9uIiwic3RhdGUiOiJNSSIsInppcCI6IjQ4MTE2IiwiaG9tZVBob25lIjoiODEwLTI5Mi05Mzg4IiwiY2VsbFBob25lIjoiODEwLTM3NC05ODQwIiwiZW1haWwiOiJqb3NlcGhpbmVfZGFyYWtqeUBkYXJha2p5Lm9yZyIsIndlYnNpdGUiOiJodHRwOi8vd3d3LmNoYW5heWplZmZyZXlhZXNxLmNvbSJ9\"\n"
			+ "            },\n"
			+ "            {\n"
			+ "                \"basicProperties\": {\n"
			+ "                    \"contentType\": \"text/plain\",\n"
			+ "                    \"contentEncoding\": \"UTF-8\",\n"
			+ "                    \"headers\": {\n"
			+ "                        \"MessageNumberInBatch\": 2,\n"
			+ "                        \"MessageBatchIdentifier\": {\n"
			+ "                            \"bytes\": [\n"
			+ "                                84,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                116,\n"
			+ "                                77,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                115,\n"
			+ "                                97,\n"
			+ "                                103,\n"
			+ "                                101,\n"
			+ "                                48,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                49,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48\n"
			+ "                            ]\n"
			+ "                        }\n"
			+ "                    },\n"
			+ "                    \"deliveryMode\": 2,\n"
			+ "                    \"priority\": 1,\n"
			+ "                    \"correlationId\": \"TestMessage03-07-02-2023-01-07-20-2\",\n"
			+ "                    \"replyTo\": null,\n"
			+ "                    \"expiration\": 60000,\n"
			+ "                    \"messageId\": \"TestMessage03-07-02-2023-01-07-20:2\",\n"
			+ "                    \"timestamp\": \"Jul 2, 2023, 1:30:34 AM\",\n"
			+ "                    \"type\": \"JsonRabbitMQProducer\",\n"
			+ "                    \"userId\": \"admin\",\n"
			+ "                    \"appId\": \"rabbitmq.producer.JsonRabbitMQProducer\",\n"
			+ "                    \"clusterId\": \"b-22450561-3f76-4004-813d-392346f054fe.mq.us-west-2.amazonaws.com\",\n"
			+ "                    \"bodySize\": 297\n"
			+ "                },\n"
			+ "                \"redelivered\": false,\n"
			+ "                \"data\": \"eyJmaXJzdG5hbWUiOiJBcnQiLCJsYXN0bmFtZSI6IlZlbmVyZSIsImNvbXBhbnkiOiJcIkNoZW1lbCwgSmFtZXMgTCBDcGFcIiIsInN0cmVldCI6IjggVyBDZXJyaXRvcyBBdmUgIzU0IiwiY2l0eSI6IkJyaWRnZXBvcnQiLCJjb3VudHkiOiJHbG91Y2VzdGVyIiwic3RhdGUiOiJOSiIsInppcCI6IjgwMTQiLCJob21lUGhvbmUiOiI4NTYtNjM2LTg3NDkiLCJjZWxsUGhvbmUiOiI4NTYtMjY0LTQxMzAiLCJlbWFpbCI6ImFydEB2ZW5lcmUub3JnIiwid2Vic2l0ZSI6Imh0dHA6Ly93d3cuY2hlbWVsamFtZXNsY3BhLmNvbSJ9\"\n"
			+ "            },\n"
			+ "            {\n"
			+ "                \"basicProperties\": {\n"
			+ "                    \"contentType\": \"text/plain\",\n"
			+ "                    \"contentEncoding\": \"UTF-8\",\n"
			+ "                    \"headers\": {\n"
			+ "                        \"MessageNumberInBatch\": 3,\n"
			+ "                        \"MessageBatchIdentifier\": {\n"
			+ "                            \"bytes\": [\n"
			+ "                                84,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                116,\n"
			+ "                                77,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                115,\n"
			+ "                                97,\n"
			+ "                                103,\n"
			+ "                                101,\n"
			+ "                                48,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                49,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48\n"
			+ "                            ]\n"
			+ "                        }\n"
			+ "                    },\n"
			+ "                    \"deliveryMode\": 2,\n"
			+ "                    \"priority\": 1,\n"
			+ "                    \"correlationId\": \"TestMessage03-07-02-2023-01-07-20-3\",\n"
			+ "                    \"replyTo\": null,\n"
			+ "                    \"expiration\": 60000,\n"
			+ "                    \"messageId\": \"TestMessage03-07-02-2023-01-07-20:3\",\n"
			+ "                    \"timestamp\": \"Jul 2, 2023, 1:30:34 AM\",\n"
			+ "                    \"type\": \"JsonRabbitMQProducer\",\n"
			+ "                    \"userId\": \"admin\",\n"
			+ "                    \"appId\": \"rabbitmq.producer.JsonRabbitMQProducer\",\n"
			+ "                    \"clusterId\": \"b-22450561-3f76-4004-813d-392346f054fe.mq.us-west-2.amazonaws.com\",\n"
			+ "                    \"bodySize\": 302\n"
			+ "                },\n"
			+ "                \"redelivered\": false,\n"
			+ "                \"data\": \"eyJmaXJzdG5hbWUiOiJMZW5uYSIsImxhc3RuYW1lIjoiUGFwcm9ja2kiLCJjb21wYW55IjoiRmVsdHogUHJpbnRpbmcgU2VydmljZSIsInN0cmVldCI6IjYzOSBNYWluIFN0IiwiY2l0eSI6IkFuY2hvcmFnZSIsImNvdW50eSI6IkFuY2hvcmFnZSIsInN0YXRlIjoiQUsiLCJ6aXAiOiI5OTUwMSIsImhvbWVQaG9uZSI6IjkwNy0zODUtNDQxMiIsImNlbGxQaG9uZSI6IjkwNy05MjEtMjAxMCIsImVtYWlsIjoibHBhcHJvY2tpQGhvdG1haWwuY29tIiwid2Vic2l0ZSI6Imh0dHA6Ly93d3cuZmVsdHpwcmludGluZ3NlcnZpY2UuY29tIn0=\"\n"
			+ "            },\n"
			+ "            {\n"
			+ "                \"basicProperties\": {\n"
			+ "                    \"contentType\": \"text/plain\",\n"
			+ "                    \"contentEncoding\": \"UTF-8\",\n"
			+ "                    \"headers\": {\n"
			+ "                        \"MessageNumberInBatch\": 4,\n"
			+ "                        \"MessageBatchIdentifier\": {\n"
			+ "                            \"bytes\": [\n"
			+ "                                84,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                116,\n"
			+ "                                77,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                115,\n"
			+ "                                97,\n"
			+ "                                103,\n"
			+ "                                101,\n"
			+ "                                48,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                49,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48\n"
			+ "                            ]\n"
			+ "                        }\n"
			+ "                    },\n"
			+ "                    \"deliveryMode\": 2,\n"
			+ "                    \"priority\": 1,\n"
			+ "                    \"correlationId\": \"TestMessage03-07-02-2023-01-07-20-4\",\n"
			+ "                    \"replyTo\": null,\n"
			+ "                    \"expiration\": 60000,\n"
			+ "                    \"messageId\": \"TestMessage03-07-02-2023-01-07-20:4\",\n"
			+ "                    \"timestamp\": \"Jul 2, 2023, 1:30:34 AM\",\n"
			+ "                    \"type\": \"JsonRabbitMQProducer\",\n"
			+ "                    \"userId\": \"admin\",\n"
			+ "                    \"appId\": \"rabbitmq.producer.JsonRabbitMQProducer\",\n"
			+ "                    \"clusterId\": \"b-22450561-3f76-4004-813d-392346f054fe.mq.us-west-2.amazonaws.com\",\n"
			+ "                    \"bodySize\": 295\n"
			+ "                },\n"
			+ "                \"redelivered\": false,\n"
			+ "                \"data\": \"eyJmaXJzdG5hbWUiOiJEb25ldHRlIiwibGFzdG5hbWUiOiJGb2xsZXIiLCJjb21wYW55IjoiUHJpbnRpbmcgRGltZW5zaW9ucyIsInN0cmVldCI6IjM0IENlbnRlciBTdCIsImNpdHkiOiJIYW1pbHRvbiIsImNvdW50eSI6IkJ1dGxlciIsInN0YXRlIjoiT0giLCJ6aXAiOiI0NTAxMSIsImhvbWVQaG9uZSI6IjUxMy01NzAtMTg5MyIsImNlbGxQaG9uZSI6IjUxMy01NDktNDU2MSIsImVtYWlsIjoiZG9uZXR0ZS5mb2xsZXJAY294Lm5ldCIsIndlYnNpdGUiOiJodHRwOi8vd3d3LnByaW50aW5nZGltZW5zaW9ucy5jb20ifQ==\"\n"
			+ "            },\n"
			+ "            {\n"
			+ "                \"basicProperties\": {\n"
			+ "                    \"contentType\": \"text/plain\",\n"
			+ "                    \"contentEncoding\": \"UTF-8\",\n"
			+ "                    \"headers\": {\n"
			+ "                        \"MessageNumberInBatch\": 5,\n"
			+ "                        \"MessageBatchIdentifier\": {\n"
			+ "                            \"bytes\": [\n"
			+ "                                84,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                116,\n"
			+ "                                77,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                115,\n"
			+ "                                97,\n"
			+ "                                103,\n"
			+ "                                101,\n"
			+ "                                48,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                49,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48\n"
			+ "                            ]\n"
			+ "                        }\n"
			+ "                    },\n"
			+ "                    \"deliveryMode\": 2,\n"
			+ "                    \"priority\": 1,\n"
			+ "                    \"correlationId\": \"TestMessage03-07-02-2023-01-07-20-5\",\n"
			+ "                    \"replyTo\": null,\n"
			+ "                    \"expiration\": 60000,\n"
			+ "                    \"messageId\": \"TestMessage03-07-02-2023-01-07-20:5\",\n"
			+ "                    \"timestamp\": \"Jul 2, 2023, 1:30:34 AM\",\n"
			+ "                    \"type\": \"JsonRabbitMQProducer\",\n"
			+ "                    \"userId\": \"admin\",\n"
			+ "                    \"appId\": \"rabbitmq.producer.JsonRabbitMQProducer\",\n"
			+ "                    \"clusterId\": \"b-22450561-3f76-4004-813d-392346f054fe.mq.us-west-2.amazonaws.com\",\n"
			+ "                    \"bodySize\": 292\n"
			+ "                },\n"
			+ "                \"redelivered\": false,\n"
			+ "                \"data\": \"eyJmaXJzdG5hbWUiOiJTaW1vbmEiLCJsYXN0bmFtZSI6Ik1vcmFzY2EiLCJjb21wYW55IjoiXCJDaGFwbWFuLCBSb3NzIEUgRXNxXCIiLCJzdHJlZXQiOiIzIE1jYXVsZXkgRHIiLCJjaXR5IjoiQXNobGFuZCIsImNvdW50eSI6IkFzaGxhbmQiLCJzdGF0ZSI6Ik9IIiwiemlwIjoiNDQ4MDUiLCJob21lUGhvbmUiOiI0MTktNTAzLTI0ODQiLCJjZWxsUGhvbmUiOiI0MTktODAwLTY3NTkiLCJlbWFpbCI6InNpbW9uYUBtb3Jhc2NhLmNvbSIsIndlYnNpdGUiOiJodHRwOi8vd3d3LmNoYXBtYW5yb3NzZWVzcS5jb20ifQ==\"\n"
			+ "            },\n"
			+ "            {\n"
			+ "                \"basicProperties\": {\n"
			+ "                    \"contentType\": \"text/plain\",\n"
			+ "                    \"contentEncoding\": \"UTF-8\",\n"
			+ "                    \"headers\": {\n"
			+ "                        \"MessageNumberInBatch\": 6,\n"
			+ "                        \"MessageBatchIdentifier\": {\n"
			+ "                            \"bytes\": [\n"
			+ "                                84,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                116,\n"
			+ "                                77,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                115,\n"
			+ "                                97,\n"
			+ "                                103,\n"
			+ "                                101,\n"
			+ "                                48,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                49,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48\n"
			+ "                            ]\n"
			+ "                        }\n"
			+ "                    },\n"
			+ "                    \"deliveryMode\": 2,\n"
			+ "                    \"priority\": 1,\n"
			+ "                    \"correlationId\": \"TestMessage03-07-02-2023-01-07-20-6\",\n"
			+ "                    \"replyTo\": null,\n"
			+ "                    \"expiration\": 60000,\n"
			+ "                    \"messageId\": \"TestMessage03-07-02-2023-01-07-20:6\",\n"
			+ "                    \"timestamp\": \"Jul 2, 2023, 1:30:34 AM\",\n"
			+ "                    \"type\": \"JsonRabbitMQProducer\",\n"
			+ "                    \"userId\": \"admin\",\n"
			+ "                    \"appId\": \"rabbitmq.producer.JsonRabbitMQProducer\",\n"
			+ "                    \"clusterId\": \"b-22450561-3f76-4004-813d-392346f054fe.mq.us-west-2.amazonaws.com\",\n"
			+ "                    \"bodySize\": 289\n"
			+ "                },\n"
			+ "                \"redelivered\": false,\n"
			+ "                \"data\": \"eyJmaXJzdG5hbWUiOiJNaXRzdWUiLCJsYXN0bmFtZSI6IlRvbGxuZXIiLCJjb21wYW55IjoiTW9ybG9uZyBBc3NvY2lhdGVzIiwic3RyZWV0IjoiNyBFYWRzIFN0IiwiY2l0eSI6IkNoaWNhZ28iLCJjb3VudHkiOiJDb29rIiwic3RhdGUiOiJJTCIsInppcCI6IjYwNjMyIiwiaG9tZVBob25lIjoiNzczLTU3My02OTE0IiwiY2VsbFBob25lIjoiNzczLTkyNC04NTY1IiwiZW1haWwiOiJtaXRzdWVfdG9sbG5lckB5YWhvby5jb20iLCJ3ZWJzaXRlIjoiaHR0cDovL3d3dy5tb3Jsb25nYXNzb2NpYXRlcy5jb20ifQ==\"\n"
			+ "            },\n"
			+ "            {\n"
			+ "                \"basicProperties\": {\n"
			+ "                    \"contentType\": \"text/plain\",\n"
			+ "                    \"contentEncoding\": \"UTF-8\",\n"
			+ "                    \"headers\": {\n"
			+ "                        \"MessageNumberInBatch\": 7,\n"
			+ "                        \"MessageBatchIdentifier\": {\n"
			+ "                            \"bytes\": [\n"
			+ "                                84,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                116,\n"
			+ "                                77,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                115,\n"
			+ "                                97,\n"
			+ "                                103,\n"
			+ "                                101,\n"
			+ "                                48,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                49,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48\n"
			+ "                            ]\n"
			+ "                        }\n"
			+ "                    },\n"
			+ "                    \"deliveryMode\": 2,\n"
			+ "                    \"priority\": 1,\n"
			+ "                    \"correlationId\": \"TestMessage03-07-02-2023-01-07-20-7\",\n"
			+ "                    \"replyTo\": null,\n"
			+ "                    \"expiration\": 60000,\n"
			+ "                    \"messageId\": \"TestMessage03-07-02-2023-01-07-20:7\",\n"
			+ "                    \"timestamp\": \"Jul 2, 2023, 1:30:34 AM\",\n"
			+ "                    \"type\": \"JsonRabbitMQProducer\",\n"
			+ "                    \"userId\": \"admin\",\n"
			+ "                    \"appId\": \"rabbitmq.producer.JsonRabbitMQProducer\",\n"
			+ "                    \"clusterId\": \"b-22450561-3f76-4004-813d-392346f054fe.mq.us-west-2.amazonaws.com\",\n"
			+ "                    \"bodySize\": 293\n"
			+ "                },\n"
			+ "                \"redelivered\": false,\n"
			+ "                \"data\": \"eyJmaXJzdG5hbWUiOiJMZW90YSIsImxhc3RuYW1lIjoiRGlsbGlhcmQiLCJjb21wYW55IjoiQ29tbWVyY2lhbCBQcmVzcyIsInN0cmVldCI6IjcgVyBKYWNrc29uIEJsdmQiLCJjaXR5IjoiU2FuIEpvc2UiLCJjb3VudHkiOiJTYW50YSBDbGFyYSIsInN0YXRlIjoiQ0EiLCJ6aXAiOiI5NTExMSIsImhvbWVQaG9uZSI6IjQwOC03NTItMzUwMCIsImNlbGxQaG9uZSI6IjQwOC04MTMtMTEwNSIsImVtYWlsIjoibGVvdGFAaG90bWFpbC5jb20iLCJ3ZWJzaXRlIjoiaHR0cDovL3d3dy5jb21tZXJjaWFscHJlc3MuY29tIn0=\"\n"
			+ "            },\n"
			+ "            {\n"
			+ "                \"basicProperties\": {\n"
			+ "                    \"contentType\": \"text/plain\",\n"
			+ "                    \"contentEncoding\": \"UTF-8\",\n"
			+ "                    \"headers\": {\n"
			+ "                        \"MessageNumberInBatch\": 8,\n"
			+ "                        \"MessageBatchIdentifier\": {\n"
			+ "                            \"bytes\": [\n"
			+ "                                84,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                116,\n"
			+ "                                77,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                115,\n"
			+ "                                97,\n"
			+ "                                103,\n"
			+ "                                101,\n"
			+ "                                48,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                49,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48\n"
			+ "                            ]\n"
			+ "                        }\n"
			+ "                    },\n"
			+ "                    \"deliveryMode\": 2,\n"
			+ "                    \"priority\": 1,\n"
			+ "                    \"correlationId\": \"TestMessage03-07-02-2023-01-07-20-8\",\n"
			+ "                    \"replyTo\": null,\n"
			+ "                    \"expiration\": 60000,\n"
			+ "                    \"messageId\": \"TestMessage03-07-02-2023-01-07-20:8\",\n"
			+ "                    \"timestamp\": \"Jul 2, 2023, 1:30:34 AM\",\n"
			+ "                    \"type\": \"JsonRabbitMQProducer\",\n"
			+ "                    \"userId\": \"admin\",\n"
			+ "                    \"appId\": \"rabbitmq.producer.JsonRabbitMQProducer\",\n"
			+ "                    \"clusterId\": \"b-22450561-3f76-4004-813d-392346f054fe.mq.us-west-2.amazonaws.com\",\n"
			+ "                    \"bodySize\": 309\n"
			+ "                },\n"
			+ "                \"redelivered\": false,\n"
			+ "                \"data\": \"eyJmaXJzdG5hbWUiOiJTYWdlIiwibGFzdG5hbWUiOiJXaWVzZXIiLCJjb21wYW55IjoiVHJ1aGxhciBBbmQgVHJ1aGxhciBBdHR5cyIsInN0cmVldCI6IjUgQm9zdG9uIEF2ZSAjODgiLCJjaXR5IjoiU2lvdXggRmFsbHMiLCJjb3VudHkiOiJNaW5uZWhhaGEiLCJzdGF0ZSI6IlNEIiwiemlwIjoiNTcxMDUiLCJob21lUGhvbmUiOiI2MDUtNDE0LTIxNDciLCJjZWxsUGhvbmUiOiI2MDUtNzk0LTQ4OTUiLCJlbWFpbCI6InNhZ2Vfd2llc2VyQGNveC5uZXQiLCJ3ZWJzaXRlIjoiaHR0cDovL3d3dy50cnVobGFyYW5kdHJ1aGxhcmF0dHlzLmNvbSJ9\"\n"
			+ "            },\n"
			+ "            {\n"
			+ "                \"basicProperties\": {\n"
			+ "                    \"contentType\": \"text/plain\",\n"
			+ "                    \"contentEncoding\": \"UTF-8\",\n"
			+ "                    \"headers\": {\n"
			+ "                        \"MessageNumberInBatch\": 9,\n"
			+ "                        \"MessageBatchIdentifier\": {\n"
			+ "                            \"bytes\": [\n"
			+ "                                84,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                116,\n"
			+ "                                77,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                115,\n"
			+ "                                97,\n"
			+ "                                103,\n"
			+ "                                101,\n"
			+ "                                48,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                49,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48\n"
			+ "                            ]\n"
			+ "                        }\n"
			+ "                    },\n"
			+ "                    \"deliveryMode\": 2,\n"
			+ "                    \"priority\": 1,\n"
			+ "                    \"correlationId\": \"TestMessage03-07-02-2023-01-07-20-9\",\n"
			+ "                    \"replyTo\": null,\n"
			+ "                    \"expiration\": 60000,\n"
			+ "                    \"messageId\": \"TestMessage03-07-02-2023-01-07-20:9\",\n"
			+ "                    \"timestamp\": \"Jul 2, 2023, 1:30:34 AM\",\n"
			+ "                    \"type\": \"JsonRabbitMQProducer\",\n"
			+ "                    \"userId\": \"admin\",\n"
			+ "                    \"appId\": \"rabbitmq.producer.JsonRabbitMQProducer\",\n"
			+ "                    \"clusterId\": \"b-22450561-3f76-4004-813d-392346f054fe.mq.us-west-2.amazonaws.com\",\n"
			+ "                    \"bodySize\": 312\n"
			+ "                },\n"
			+ "                \"redelivered\": false,\n"
			+ "                \"data\": \"eyJmaXJzdG5hbWUiOiJLcmlzIiwibGFzdG5hbWUiOiJNYXJyaWVyIiwiY29tcGFueSI6IlwiS2luZywgQ2hyaXN0b3BoZXIgQSBFc3FcIiIsInN0cmVldCI6IjIyOCBSdW5hbXVjayBQbCAjMjgwOCIsImNpdHkiOiJCYWx0aW1vcmUiLCJjb3VudHkiOiJCYWx0aW1vcmUgQ2l0eSIsInN0YXRlIjoiTUQiLCJ6aXAiOiIyMTIyNCIsImhvbWVQaG9uZSI6IjQxMC02NTUtODcyMyIsImNlbGxQaG9uZSI6IjQxMC04MDQtNDY5NCIsImVtYWlsIjoia3Jpc0BnbWFpbC5jb20iLCJ3ZWJzaXRlIjoiaHR0cDovL3d3dy5raW5nY2hyaXN0b3BoZXJhZXNxLmNvbSJ9\"\n"
			+ "            },\n"
			+ "            {\n"
			+ "                \"basicProperties\": {\n"
			+ "                    \"contentType\": \"text/plain\",\n"
			+ "                    \"contentEncoding\": \"UTF-8\",\n"
			+ "                    \"headers\": {\n"
			+ "                        \"MessageNumberInBatch\": 10,\n"
			+ "                        \"MessageBatchIdentifier\": {\n"
			+ "                            \"bytes\": [\n"
			+ "                                84,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                116,\n"
			+ "                                77,\n"
			+ "                                101,\n"
			+ "                                115,\n"
			+ "                                115,\n"
			+ "                                97,\n"
			+ "                                103,\n"
			+ "                                101,\n"
			+ "                                48,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48,\n"
			+ "                                50,\n"
			+ "                                51,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                49,\n"
			+ "                                45,\n"
			+ "                                48,\n"
			+ "                                55,\n"
			+ "                                45,\n"
			+ "                                50,\n"
			+ "                                48\n"
			+ "                            ]\n"
			+ "                        }\n"
			+ "                    },\n"
			+ "                    \"deliveryMode\": 2,\n"
			+ "                    \"priority\": 1,\n"
			+ "                    \"correlationId\": \"TestMessage03-07-02-2023-01-07-20-10\",\n"
			+ "                    \"replyTo\": null,\n"
			+ "                    \"expiration\": 60000,\n"
			+ "                    \"messageId\": \"TestMessage03-07-02-2023-01-07-20:10\",\n"
			+ "                    \"timestamp\": \"Jul 2, 2023, 1:30:34 AM\",\n"
			+ "                    \"type\": \"JsonRabbitMQProducer\",\n"
			+ "                    \"userId\": \"admin\",\n"
			+ "                    \"appId\": \"rabbitmq.producer.JsonRabbitMQProducer\",\n"
			+ "                    \"clusterId\": \"b-22450561-3f76-4004-813d-392346f054fe.mq.us-west-2.amazonaws.com\",\n"
			+ "                    \"bodySize\": 300\n"
			+ "                },\n"
			+ "                \"redelivered\": false,\n"
			+ "                \"data\": \"eyJmaXJzdG5hbWUiOiJNaW5uYSIsImxhc3RuYW1lIjoiQW1pZ29uIiwiY29tcGFueSI6IlwiRG9ybCwgSmFtZXMgSiBFc3FcIiIsInN0cmVldCI6IjIzNzEgSmVycm9sZCBBdmUiLCJjaXR5IjoiS3VscHN2aWxsZSIsImNvdW50eSI6Ik1vbnRnb21lcnkiLCJzdGF0ZSI6IlBBIiwiemlwIjoiMTk0NDMiLCJob21lUGhvbmUiOiIyMTUtODc0LTEyMjkiLCJjZWxsUGhvbmUiOiIyMTUtNDIyLTg2OTQiLCJlbWFpbCI6Im1pbm5hX2FtaWdvbkB5YWhvby5jb20iLCJ3ZWJzaXRlIjoiaHR0cDovL3d3dy5kb3JsamFtZXNqZXNxLmNvbSJ9\"\n"
			+ "            }\n"
			+ "        ]\n"
			+ "    }\n"
			+ "}";

	@Mock
	DynamoDBUpdater ddbUpdater;	
	
	@Test
	@ExtendWith(MockitoExtension.class)
	void invokeTest() {
		
		ObjectMapper om = new ObjectMapper();
		//SQSEvent event = gson.fromJson(sqsEventJson, SQSEvent.class);
		RabbitMQEvent event = null;
		try {
			event = om.readValue(mqEventJson, RabbitMQEvent.class);
		} catch (JsonMappingException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (JsonProcessingException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		Context context = new TestContext();
		//PutItemOutcome putItemOutcome = mock(PutItemOutcome.class);
		DynamoDBUpdater dbUpdater = mock(DynamoDBUpdater.class);
		HandlerRabbitMQ handler = new HandlerRabbitMQ();
		handler.ddbUpdater = dbUpdater;
		String result = handler.handleRequest(event, context);
		assertEquals(result, "200");
	}

}
